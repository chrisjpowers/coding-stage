<section id="stage-list">

  <h1>Join a recently active stage</h1>

  <!--
  <form id="search">
    <input type="text" placeholder="Search for a specific stage">
  </form>
  -->
  <% if (user) { %>
  <form class="stagePicker" id="filter">
    <select>
      <option value="all">Show me all the stages</option>
      <option value="mine">Show me all of my stages</option>
    </select>
  </form>
  <% } %>

  <section class="mine">
    <% myStages.forEach(function(stage) { %>
    <a href="/stages/<%= stage.stub %>" id="stage<%= stage.id %>">
      <h1><%= stage.name %></h1>
      <h2><%= stage.language %></h2>
      <% watcherCount = stage.watchers.length %>
      <p>There's <%= watcherCount %> <%= watcherCount == 1 ? "person" : "people" %> in here</p>
      <% if(stage.creatorName) { %>
        <small>Stage created by <%= stage.creatorName %></small>
        <% } %>
      </a>
    <% }) %> 
    <% if(everyauth.loggedIn) { %>
    <a href="/stages/new" id="create">
      <p>Create your own stage&nbsp;now</p>
    </a>
    <% } %>

    <% if(!everyauth.loggedIn) { %>
    <a href="/auth/github" id="create">
      <p>Login to create your own&nbsp;stage</p>
    </a>
    <% } %>
  </section>
  <section class="all">
    <% stages.forEach(function(stage) { %>
    <a href="/stages/<%= stage.stub %>" id="stage<%= stage.id %>">
      <h1><%= stage.name %></h1>
      <h2><%= stage.language %></h2>
      <% watcherCount = stage.watchers.length %>
      <p>There's <%= watcherCount %> <%= watcherCount == 1 ? "person" : "people" %> in here</p>
      <% if(stage.creatorName) { %>
        <small>Stage created by <%= stage.creatorName %></small>
        <% } %>
      </a>
    <% }) %> 
    <% if(everyauth.loggedIn) { %>
    <a href="/stages/new" id="create">
      <p>Create your own stage&nbsp;now</p>
    </a>
    <% } %>

    <% if(!everyauth.loggedIn) { %>
    <a href="/auth/github" id="create">
      <p>Login to create your own&nbsp;stage</p>
    </a>
    <% } %>
  </section>

</section>
